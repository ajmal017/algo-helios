{% extends "users/base.html" %}

{% block profile_content %}

<link rel="stylesheet" type="text/css" href="/static/css/profile.css">
<div class="container mb-5">
<br>
<h3>DashBoard</h3>

	<div class="alertx alert alert-warning alert-dismissible fade show" role="alertx">
		<strong>Check Your Email ! Click On Verify Me</strong>
		<button type="button btn btn-dark" class="closex" data-dismiss="alert" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>

  
  <ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">
    <li class="nav-item">
      <a class="nav-link text-dark active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="true">Profile</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-dark" id="MyPlans-tab" data-toggle="tab" href="#MyPlans" role="tab" aria-controls="MyPlans" aria-selected="false">My Plans</a>
	</li>
	<li class="nav-item">
		<a class="nav-link text-dark" id="MyOrders-tab" data-toggle="tab" href="#MyOrders" role="tab" aria-controls="MyOrders" aria-selected="false">My Orders</a>
	</li>
  </ul>

  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active mt-5" id="profile" role="tabpanel" aria-labelledby="profile-tab">
		<div class="row">
			<div class="col-md-10">
				<div class="flush-left">
						<div class="card rounded">
							<div class="card-body p-2">
								<ul class="list-group list-group-flush">
									<li class="list-group-item"><b>Name : </b>{{ user.first_name }} {{user.last_name}} </li>
									<li class="list-group-item"><b>Email : </b>{{ user.email }} </li>
									<li class="list-group-item"><b>Credits :</b> <span style="font-size: large;"><span class="badge badge-pill badge-warning ">₹   {{ user.algo_credits }} </span> </span></li>
									<li class="list-group-item"><b>Last Login : </b>{{ user.last_login }}</li>
									<li class="list-group-item"><b>Your Referral Code : </b>
									<span class="badge badge-pill badge-dark p-2"> {{ user.referral_code }} </span>
										<div class="input-group input-group-sm w-75 mx-auto">
											<input type="text" class="form-control card" value="{{ referral_link }}" id="myInput">
											<div class="input-group-append">
												<span class="input-group-text btn btn-sm" id="basic-addon1"  onclick="myFunction()">copy</span>
											</div><br>
										</div>
										<small>Share link to avail 30 Credits (Applicable only Once)</small>
									</li>
									{% if not if_referred %}
										<li class="list-group-item">
										<form class="form-inline" action="/user/refer/user={{ user.referal_code }}" method="POST">
											{% csrf_token %}
											<div class="form-group">
												<label for=""><b>Enter Referal Code</b></label>
												<input type="text" id="" maxlength="6" class="mt-1 form-control mx-sm-3" aria-describedby="passwordHelpInline">
												<button class="btn btn-dark btn-sm mt-1" type="submit">Ok</button>
											</div>
											</form>
										</li>
									{% endif %}
								</ul>
							</div> 
						</div>
				</div>
			</div>
		</div> 
	</div> <!-- profile tab ends-->
    <!-- ------------------------------------------------------------------------------------------ -->
    
    <div class="tab-pane fade" id="MyPlans" role="tabpanel" aria-labelledby="MyPlans-tab">
	  
		<h3 class="mt-5">Personal Plans</h3>
      		{% if iplans %}
      			<div class="container mt-5">
          			<div class="row">
          				{% for iplan in iplans %}
              				<div class="mb-3 col-md-4">
		
                				<div class="card shadow-sm">     
                  					<div class="card-header">
                    					<h4 class="my-0 font-weight-normal">{{iplan.plan_id__plan_name}} <span class="badge badge-pill badge-warning">{{iplan.subscription_type_id__type_name}}</span><br></h4>
									</div>
									  
                  					<div class="card-body">
											{% if iplan.subscription_type_id__type_name == "Trial" %}
											<p class="lead"> Subscribe With the following Plan</p>
											<p class="card-title pricing-card-title text-weight-bold"> <b> Monthly Price : ₹</b> {{iplan.plan_id__price_per_month}} <small class="text-muted">/ mo</small></p>
											<p class="card-title pricing-card-title"><b>Yearly Price : ₹ </b>{{iplan.plan_id__price_per_year}}<small class="text-muted">/ yr</small></p>
										  {% elif iplan.subscription_type_id__type_name == "Monthly" %}
											<p class="card-title pricing-card-title"><b>Monthly Price :  ₹ </b>{{iplan.plan_id__price_per_month}} <small class="text-muted">/ mo</small></p>
										  {% else %}
											<p class="card-title pricing-card-title"><b>Yearly Price : ₹ </b>{{iplan.plan_id__price_per_year}}<small class="text-muted">/ yr</small></p>
										  {% endif %}
											<ul class="list-group mb-4">
											  <li class="list-group-item list-group-item-info mb-3"><b>Start Date : </b>{{ iplan.subscription_start }}</li>
											  <li class="list-group-item list-group-item-danger"><b>End Date : </b>{{ iplan.subscription_end }}</li>
											</ul>
								  
											{% if iplan.subscription_type_id__type_name == "Trial" %}
											  <button type="button" class="btn btn-block btn-outline-primary">Subscribe</button>
											{% else %}
											  <button type="button" class="btn btn-block btn-outline-primary">Renew</button>
											{% endif %}
                  					</div>
								</div>
								
              				</div>
          				{% endfor %}
		  			</div>
      			</div>
			{% else %}
				<h6>No Personal Plans Yet</h6>
			{% endif %}

      <!-- ------------------------------- -->
      <h3>Group Plans</h3>
      
      {% if gplans %}
      <div class="container mt-5">
          <div class="row">
		  {% for gplan in gplans %}
              <div class="mb-3 col-md-4">
                <div class="card shadow-sm">     
                  <div class="card-header">
                    <h4 class="my-0 font-weight-normal">{{gplan.plan_id__plan_name}} <span class="badge badge-pill badge-warning">{{gplan.subscription_type_id__type_name}}</span><br></h4>
                  </div>
                  <div class="card-body">
                    {% if gplan.subscription_type_id__type_name == "Trial" %}
                      <p class="lead"> Subscribe With the following Plan</p>
                      <p class="card-title pricing-card-title text-weight-bold"> <b> Monthly Price : ₹</b> {{gplan.plan_id__price_per_month}} <small class="text-muted">/ mo</small></p>
                      <p class="card-title pricing-card-title"><b>Yearly Price : ₹ </b>{{gplan.plan_id__price_per_year}}<small class="text-muted">/ yr</small></p>
                    {% elif gplan.subscription_type_id__type_name == "Monthly" %}
                      <p class="card-title pricing-card-title"><b>Monthly Price :  ₹ </b>{{gplan.plan_id__price_per_month}} <small class="text-muted">/ mo</small></p>
                    {% else %}
                      <p class="card-title pricing-card-title"><b>Yearly Price : ₹ </b>{{gplan.plan_id__price_per_year}}<small class="text-muted">/ yr</small></p>
                    {% endif %}
                      <ul class="list-group mb-4">
						<li class="list-group-item list-group-item-info mb-3"><b>Start Date : </b>{{ gplan.subscription_start }}</li>
						<li class="list-group-item list-group-item-danger"><b>End Date : </b>{{ gplan.subscription_end }}</li>
                      </ul>
            
                      {% if gplan.subscription_type_id__type_name == "Trial" %}
                        <button type="button" class="btn btn-block btn-outline-primary">Subscribe</button>
                      {% else %}
                        <button type="button" class="btn btn-block btn-outline-primary">Renew</button>
                      {% endif %}
                      
                  </div>
                </div>
              </div>
          {% endfor %}
          </div>
      {% else %}
        <h6>No Group Plans Yet</h6>
	
		{% endif %}  
		</div> <!-- Plan tab ends-->
		<!-- ------------------------------------------------------------------------------------------ -->

	  <div class="tab-pane fade mt-5" id="MyOrders" role="tabpanel" aria-labelledby="MyOrders-tab">
			<h3>Invoice</h3><hr>
			

	  </div>

	</div> <!-- Tab Content ends -->
  </div> <!-- Container ends -->
</div> 

<script type="text/javascript">

$('.alertx').alert()
  $(function () {
    $('[data-toggle="tooltip"]').tooltip()
  })

</script>

<script type="text/javascript">
  function myFunction() {
  /* Get the text field */
  var copyText = document.getElementById("myInput");

  /* Select the text field */
  copyText.select();
  copyText.setSelectionRange(0, 99999); /*For mobile devices*/

  /* Copy the text inside the text field */
  document.execCommand("copy");

  /* Alert the copied text */
  alert("Copied the text: " + copyText.value);
}
</script>

{% endblock %}