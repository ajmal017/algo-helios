{% extends 'subscriptions/base.html' %}
{% load define_action %}

<!-- {% load static %} -->

{% block css_imports %}
	<link rel="stylesheet" type="text/css" href="{% static '/css/plans.css' %}">
{% endblock %}
{% block js_imports %}	
	<!-- <script src="{% static '/js/plans.js' %}" type="text/javascript"></script> -->
{% endblock %}

<style>

</style>

{% block subscriptions_content %}

<div class="container-fluid mb-4 tabbable boxed parentTabs" style="padding-top: 120px;">
    <div class="row ">
        <div class="col text-center">

				<div class="header text-center ">
					<div class="row justify-content-center" id="alg-plans-head" role="tablist">
						
						<!-- <div id = "ah-left" class="col-md-2 mt-3" ><a id = "ah-left-a" class=" link-unstyled text-dark" role="tab" aria-controls="services" aria-selected="true"></a><br></div> -->
						<div id = "ah-center" class="col-md-3 xx-large  border-primary border-bottom"      aria-selected="true"><a id = "ah-center-a" href='#plans' class="font-weight-bold dark-blue" role="tab" aria-controls="head">MERCURY</a></div>
						<div id = "ah-right" class="col-md-3  x-large"><a id = "ah-right-a" class="link-unstyled text-dark" role="tab"  href="#services" aria-controls="services" aria-selected="true">SERVICES</a><br></div>
						
					</div>
				</div>
        </div>

	</div>
	
	<div class="tab-content" id = "pricing-page">
		<div class="tab-pane active" id="plans" role="tabpanel">
			<div class="tabbable">
				<div class="row mt-4 ">
					<div class="col-md-12">
						<div class="font-weight-bold mb-3 text-center" style="color: darkblue;"> NUMBER OF USERS</div>
						<div class="btn-toolbar justify-content-center" role="toolbar" aria-label="Toolbar with button groups">
							
							<div id = "group-header text-center" class="btn-group " role="group" aria-label="First group">
								<script>
									$(document).ready(() => {
										var active = "#head-{{group_type.0.1}}";
										
										$("#{{details.0.1}}").addClass("show active")  // adding class to show first element
										$("#head-{{details.0.1}}").addClass("active")  // adding class to active first element head

										$("#group-header").click(()=>{
											$("#group-header").css({"border-style": "none", "border-color": DARK_BLUE})
			
										})

									});
								</script>
								{% for group_type in details %}	
									<a id = "head-{{ group_type.1 }}" type="btn btn-dark" class="btn  dark-blue shadow-lg text-light " style="border-color:#23527c" data-toggle="tab"  href="#{{group_type.1}}" role="tab" aria-controls="tabs-{{group_type.1}}" aria-selected="true">
										<span class="font-weight-bold dark-blue p-2">{{ group_type.1.max_members }}<span>
									</a>
									<script>
										$(document).ready(() => {
											var non_active = "#head-{{df}}";
											active = "#head-{{group_type.1}}"
											$("#head-{{ group_type.1 }}").click(() =>{
												var current_clicked_id = "#head-{{ group_type.1 }}"
												if(active != "#head-{{ group_type.1 }}"){
													$("#head-{{ group_type.1 }}").fadeIn("slow");
													$("#head-{{ group_type.1 }}").css("background-color", "#daedf4")
													$(active).css("background-color", "white");
													active =  "#head-{{ group_type.1 }}"
													$('input[name="groupcode"]').val("{{group_type.1}}");
												}
												
											});
										});
									</script>
								{% endfor %}
								
							</div>
			
							
						</div>
						
					</div>
				</div>
			
				<div class="row text-center">
					<div class="col-md-12">
						<div class="card-body text-dark">
							<ul class="list-group mr-5 ml-5">
								<div class="form-control border-0 list-group_item ">
									<span class="badge badge-pill badge-warning">Choose Period</span><br>
									<div class="btn-group btn-group-toggle" data-toggle="buttons">
										<label class="btn btn-primary" id = "period-monthly-label">
											<input type="radio" name="period" id = "period-monthly-input" autocomplete="off" value="monthly"> <span class="font-weight-bold"> Monthly</span><br>
										</label>
										<label class = "btn btn-primary" id = "period-yearly-label">
											<input type="radio" name="period" id="period-yearly-input" autocomplete="off" value="yearly"> <span class="font-weight-bold"> Yearly</span>
										</label>
									</div>
									
								</div>
							</ul>
							<script>
								$(document).ready(function(){
									$("#period-monthly-label").css({"background-color": DARK_BLUE, "color" : WHITE})
									$("#period-yearly-label").css({"background-color": WHITE, "color" : DARK_BLUE});
									$('input[name="period"]').val("monthly");
			
									$("#period-yearly-label").css({"background-color": WHITE, "color" : DARK_BLUE});
									$("#period-monthly-label").click(() =>{
										$("#period-monthly-label").css({"background-color": DARK_BLUE, "color" : WHITE})
										$("#period-yearly-label").css({"background-color": WHITE, "color" : DARK_BLUE});
									});
									$("#period-yearly-label").click(() =>{
										$("#period-yearly-label").css({"background-color": DARK_BLUE, "color" : WHITE})
										$("#period-monthly-label").css({"background-color": WHITE, "color" : DARK_BLUE});
									});
									
								});
							</script>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col">
						
						<div class="tab-content" id="pills-tabContent">                
						{% for group_type in details %}
							<div class="tab-pane" id="{{group_type.1}}" role="tabpanel" aria-labelledby="pills-individual-tab">
								<div class="row">
									{% for plan_type in group_type.0 %}
										<script>
											$(document).ready(function(){
												$('input[name="plancode"]').val("{{plan_type.1}}");
												$("#{{group_type.1}}-{{plan_type.1}}-price-in-rupees").html("<p>₹ {{plan_type.0.0.1.price_per_month}} / Month</p>");
													$("#period-monthly-label").click(()=>{
														$('input[name="period"]').val("Monthly");
														$("#{{group_type.1}}-{{plan_type.1}}-price-in-rupees").html("<p>₹ {{plan_type.0.0.1.price_per_month}} / Month</p>");
													});
													$("#period-yearly-label").click(()=>{
														$("#{{group_type.1}}-{{plan_type.1}}-price-in-rupees").html("<p>₹ {{plan_type.0.0.1.price_per_year}} / Year<p>");
														$('input[name="period"]').val("Yearly");
													});
											});
										</script>
										<div class="col-md-6" style="padding: 20px;">     
											<form method = "POST" action="/subscriptions/order-details"> 
												{% csrf_token %}        
												<div class="card border rounded shadow mt-3 border plan-cards" style="min-height: 25rem;">
													
													{% if plan_type.1|upper == "PREMIUM" %}
														<span class = "star-premium text-right" style="position: absolute; top:0px; right: 8px;"><span class="badge  badge-warning mr-4"><span class="fas fa-star fa-3x white"><br><br></span></span></span>
													{% else %}
					
													{% endif %}
													<a href="#ibasic"> 
														<div class="text-center pt-4 pb-0 text-dark">
															<h2 class=" xx-large">{{plan_type.1.type_name}}</h2>
															<div id = "price-tag">
																<div class="row">
																	<div id = "{{group_type.1}}-{{plan_type.1}}-price-in-rupees" class="col-md-12 content-heading">
																		
																	</div>
																</div>
				
																<div class="row">
				
																</div>
															</div>
															{{plan_type.1.type_description}}
														</div>
													</a>
									
													<div class="card-body text-dark ">
				
														<ul class="font-weight-bold list-group mr-5 ml-5">
															{% for plan in plan_type.0 %}
																
																{% if plan_type.1.products_count == 1 %}
																		<div class="form-check list-group-item pl-5">
																			<input class="form-check-input" type="radio" name="plan_name" id="{{group_type.1}}-{{plan.1}}" value="{{plan.1.plan_name}}" checked>
																			<label class="form-check-label" for="{{plan.1}}">
																				{{plan.0.0.product_name | _split:'1??#' }}
																			</label>
																		</div>
																		<script>
																			$(document).ready(()=>{
																				$("#{{group_type.1}}-{{plan_type.1}}").hover(function(){												
																					$('input[name="planname"]').val("{{plan.0.0.product_name}}");
																				}, function(){
																					console.log("{{group_type.1}}-{{plan.0.0.product_name}}")
																					$('input[name="planname"]').val("{{plan.0.0.product_name}}");
																				});
																				$("#{{group_type.1}}-{{plan_type.1}}").click(function(){
																					$('input[name="planname"]').val("{{plan.0.0.product_name}}");
																				});
																			});
																		</script>
																{% elif plan_type.1.products_count == 0 %} 
																		{% for product in plan.0 %}
																			<div class="form-check list-group-item pl-5">
																				<input class="form-check-input" type="checkbox" name="checkbox" id="{{group_type.1}}-{{plan.1}}-{{product.product_name}}" value="{{plan.1}}" checked disabled>
																				<label class="form-check-label" for="{{plan.1}}" style="color: black;">    
																					{{product.product_name | _split:"1??#"}}
																				</label>
																			</div>
																			<script>
																				$(document).ready(()=>{
																					$("#{{group_type.1}}-{{plan_type.1}}").hover(function(){												
																						$('input[name="planname"]').val("{{product.product_family_id}}");
																					}, function(){
																						console.log("{{group_type.1}}-{{product.product_name}}")
																						$('input[name="planname"]').val("{{product.product_family_id}}");
																					});
																					$("#{{group_type.1}}-{{plan_type.1}}").click(function(){
																						$('input[name="planname"]').val("{{product.product_family_id}}");
																					});
																				});
																			</script>
																		{% endfor %}
																{% endif %}
															{% endfor %}
														</ul>
													</div>
													<div class="border-light mb-3" class = "plancode-div" id = "{{group_type.1}}-{{plan_type.1}}">
														<div class="row justify-content-center">
															<div class="">
																{% if group_type.1.eligible_for_trial and plan_type.1.trial_applicable %}
																	<button type='submit' class="col btn  btn-primary plancode-div font-weight-bold"> Try Now</button>
																{% else %}
																	<button type='submit' class="col btn  btn-primary plancode-div font-weight-bold"> Subscribe</button>
																{% endif %}
															</div>
														</div>		

													</div>
												</div>
												<input class="periodcode" name = "period" value=""hidden></input>
												<input class="plancode" name= "plancode" value="" hidden></input>
												<input class="planname" name= "planname" value="" hidden></input>
												<input class="groupcode" name= "groupcode" value="" hidden required></input>
												
											</form>
				
											<script>
												$(document).ready(function(){
													console.log("{{plan_type.1}}")
													if("{{plan_type.1}}" === "Premium"){
														$("#star-premium").addClass("badge badge-pill badge-danger")
													}											
													$("#{{group_type.1}}-{{plan_type.1}}").hover(function(){												
														console.log("{{group_type.1}}-{{plan_type.1}}")
														$('input[name="plancode"]').val("{{plan_type.1}}");
													}, function(){
														console.log("{{group_type.1}}-{{plan.1}}")
														$('input[name="plancode"]').val("{{plan_type.1}}");
													});
													$("#{{group_type.1}}-{{plan_type.1}}").click(function(){
														$('input[name="plancode"]').val("{{plan_type.1}}");
													});
													
				
				
												});
											</script>
										</div>
									{% endfor %}
								</div>
								
							</div>                    
						{% endfor %}
					
						</div>
					</div>
				</div>
			</div>
			
		</div>
		<div class="tab-pane" id="services" role="tabpanel">
			<div class="row mt-3 mt-1">
				<div class="col-md-12">
					<div class="card">
						<div class="x-large dark-blue card-header rounded">
							Automation :
						</div>
						<div class="card-body">

						</div>
					</div>
				</div>
			</div>
			<div class="row mt-4">
				<div class="col-md-12">
					<div class="card">
						<div class="x-large dark-blue card-header rounded">
							Backtesting :
						</div>
						<div class="card-body">

						</div>
					</div>
				</div>
			</div>
			<div class="row mt-4">
				<div class="col-md-12">
					<div class="card">
						<div class="x-large dark-blue card-header rounded">
							Algorithm Development :
						</div>
						<div class="card-body">

						</div>
					</div>
				</div>
			</div>
			<div class="row mt-4">
				<div class="col-md-12">
					<div class="card">
						<div class="x-large dark-blue card-header rounded">
							Data Analytics :
						</div>
						<div class="card-body">

						</div>
					</div>
				</div>
			</div>
			<div class="row mt-4">
				<div class="col-md-12">
					<div class="card">
						<div class="x-large dark-blue card-header rounded">
							Custom Strategies :
						</div>
						<div class="card-body">

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock %}

{% block scripts %}
    <script>		
		$(document).ready(()=>{

			// $("div.group-header a").click(function (e) {
			// 	e.preventDefault();  
			// 		$(this).tab('show');
			// });

			$("div.header a").click(function (e) {
				e.preventDefault();  
					$(this).tab('show');
			});
			
			$("#ah-center").click(function (e) {
				$("#plans").addClass("active")
				$("#ah-center").addClass("xx-large border-primary border-bottom")
				$("#ah-center").removeClass("x-large")
				$("#ah-center-a").addClass("font-weight-bold dark-blue")
				$("#ah-center-a").removeClass("link-unstyled text-dark")
				$("#services").removeClass("active")
				$("#ah-right").removeClass("xx-large border-primary border-bottom")
				$("#ah-right").addClass("x-large")
				$("#ah-right-a").addClass("link-unstyled text-dark ")
				$("#ah-right-a").removeClass("font-weight-bold dark-blue")

			});

			$("#ah-right").click(function (e) {
				$("#plans").removeClass("active")
				$("#ah-center").removeClass("xx-large border-primary border-bottom")
				$("#ah-center").addClass("x-large")
				$("#ah-center-a").addClass("link-unstyled text-dark")
				$("#ah-center-a").removeClass("font-weight-bold dark-blue")
				$("#services").addClass("active")
				$("#ah-right").addClass("xx-large border-primary border-bottom")
				$("#ah-right").removeClass("x-large")
				
				$("#ah-right-a").addClass("font-weight-bold dark-blue")
				$("#ah-right-a").removeClass("link-unstyled text-dark")
			});
			// var a = document.getElementById("#ah-center-a")
			// a.click()

			$('input[required]').on('invalid', function(e){
				console.log("errr : ", e, e.target, e.target.name)
				if(e.target.name == "groupcode"){
					console.log("changing border")
					$("#group-header").css({"border-style": "solid", "border-color": "red"})
				}
			});
		});
    </script>
{% endblock %}